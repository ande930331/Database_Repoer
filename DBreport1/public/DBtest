CREATE TABLE LicenseType (
  license_id INT AUTO_INCREMENT PRIMARY KEY,
  license_name VARCHAR(20) NOT NULL,
  description VARCHAR(100)
);

INSERT INTO LicenseType VALUES
(1,'紅牌','550cc以上'),
(2,'黃牌','250~550cc'),
(3,'白牌','250cc以下');

CREATE TABLE Category (
  category_id INT AUTO_INCREMENT PRIMARY KEY,
  category_name VARCHAR(20) NOT NULL
);

INSERT INTO Category VALUES
(1,'仿賽'),
(2,'街跑'),
(3,'街車'),
(4,'速可達'),
(5,'冒險');

CREATE TABLE Users (
  user_id INT AUTO_INCREMENT PRIMARY KEY,
  name VARCHAR(50),
  phone VARCHAR(20),
  email VARCHAR(100) UNIQUE,
  role ENUM('buyer','seller','admin') DEFAULT 'buyer',
  password VARCHAR(255)
);

INSERT INTO Users (name, phone, email, password, role)
VALUES ('1號管理員', '000-0000000', 'admin@gmail.com', '20040331', 'admin');

CREATE TABLE Motorcycle (
  moto_id INT AUTO_INCREMENT PRIMARY KEY,
  brand VARCHAR(50),
  model VARCHAR(50),
  year SMALLINT,
  price DECIMAL(10,2),
  mileage INT,
  description TEXT,
  license_id INT,
  category_id INT,
  seller_id INT,
  image_url VARCHAR(255),
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  FOREIGN KEY (license_id) REFERENCES LicenseType(license_id),
  FOREIGN KEY (category_id) REFERENCES Category(category_id),
  FOREIGN KEY (seller_id) REFERENCES Users(user_id)
);
ALTER TABLE Motorcycle
ADD COLUMN status ENUM('available','sold','removed') DEFAULT 'available';

CREATE TABLE Reservation (
  reserve_id INT AUTO_INCREMENT PRIMARY KEY,
  moto_id INT NOT NULL,
  buyer_id INT NOT NULL,
  reserve_time DATETIME NOT NULL,
  status ENUM('pending','confirmed','canceled') DEFAULT 'pending',
  note VARCHAR(255),
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (moto_id) REFERENCES Motorcycle(moto_id) ON DELETE CASCADE,
  FOREIGN KEY (buyer_id) REFERENCES Users(user_id) ON DELETE CASCADE
);
